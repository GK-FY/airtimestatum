<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>FY Bot — QR Dashboard</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="/socket.io/socket.io.js"></script>
<style>
  body{font-family:Inter,system-ui;background:#eef6ff;color:#061226;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}
  .card{background:#fff;padding:22px;border-radius:14px;box-shadow:0 18px 40px rgba(8,18,40,0.06);width:420px;text-align:center}
  .qr{width:260px;height:260px;margin:12px auto;background:#f8fafc;display:flex;align-items:center;justify-content:center;border-radius:8px;border:1px dashed #e6edf5}
  .status{margin-top:12px;font-weight:700}
  .hint{font-size:13px;color:#6b7280;margin-top:8px}
  a.button{display:inline-block;margin-top:12px;padding:10px 14px;background:linear-gradient(90deg,#0f6fc8,#2563eb);color:#fff;border-radius:10px;text-decoration:none}
</style>
</head>
<body>
<div class="card">
  <h2>FY Bot — WhatsApp QR</h2>
  <div id="qr" class="qr">Waiting for QR...</div>
  <div id="status" class="status">Status: <span id="st">unknown</span></div>
  <div class="hint">Scan with WhatsApp → Linked devices → Link a device</div>
  <div style="margin-top:14px">
    <a class="button" id="adminLink" href="#" onclick="openAdmin(); return false;">Open Admin UI</a>
  </div>
</div>

<script>
  const socket = io();
  const qrDiv = document.getElementById('qr');
  const st = document.getElementById('st');
  socket.on('qr', data => {
    if(data && data.url){ qrDiv.innerHTML = '<img src="'+data.url+'" width="220" height="220" alt="QR">'; st.innerText='Scan QR'; }
    else { qrDiv.innerText='No QR available'; }
  });
  socket.on('status', data => { if(!data) return; if(data.connected){ st.innerText='Connected'; qrDiv.innerHTML='<div style=\"font-size:48px\">✅</div>'; } else { st.innerText='Disconnected'; } });
  
  function openAdmin() {
    const token = prompt('Enter admin token:');
    if(token) {
      window.location.href = '/admin?token=' + encodeURIComponent(token);
    }
  }
</script>
</body>
</html>
